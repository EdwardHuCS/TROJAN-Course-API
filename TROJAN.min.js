!function(){const e=require("http"),t=require("./async");var r={},o=function(t,r){function o(){e.get(t,function(e){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){try{var e=JSON.parse(t);r(e)}catch(o){console.error("Error: ",o)}})}).on("error",function(e){console.error("Error: ",e)})}t="http://web-app.usc.edu/web/soc/api"+t,setTimeout(o,150)};r.term=function(e,t){t=t||{};var r="/terms";o(r,function(r){e(t.curr?r.term[r.term.length-1]:r.term)})},r.current_term=function(e,t){r.term(e,{curr:!0})},r.dept_raw=function(e,t){function n(t){var r="/depts/"+t;o(r,function(t){e(t.department)})}t=t||{},t.term?n(t.term):r.current_term(n)},r.school=function(e,o){function n(r){t.each(r,function(t,r){(school=o.school)?t.code.toLowerCase()==school.toLowerCase()&&e(t):e(t.code),r()})}o=o||{},o.data_dump?n(o.data_dump):r.dept_raw(n,{term:o.term})},r.dept=function(e,o){function n(r){var n=[];t.each(r,function(t,r){function c(t,r){n.indexOf(t.code)>-1||(n.push(t.code),e(o.justcode?t.code:t)),r()}depts=t.department,Array.isArray(depts)?each(depts,c):void 0!=depts&&c(depts),r()})}o=o||{},r.dept_raw(function(e){o.school?r.school(function(e){n([e])},{school:o.school,data_dump:e}):n(e)},{term:o.term})},r.dept_info=function(e,t){function n(e,t,r){var n="/classes/"+e+"/"+t;o(n,function(e){r(e.Dept_Info)})}function c(t){r.dept(function(r){n(r,t,e)},{term:t,justcode:!0})}t=t||{},t.dept?t.term?n(t.dept,t.term,e):r.current_term(function(r){n(t.dept,r,e)}):t.term?c(t.term):r.current_term(function(e){c(e)})},r.course_raw=function(e,n){function c(e,r,c){var u="/classes/"+e+"/"+r;o(u,function(e){var r=e.OfferedCourses.course;Array.isArray(r)?t.each(r,function(e,t){c(n.justcode?e.ScheduledCourseID:e),t()}):void 0!=r&&c(n.justcode?r.ScheduledCourseID:r)})}function u(t){r.dept(function(r){c(r,t,e)},{justcode:!0})}n=n||{},n.dept?n.term?c(n.dept,n.term,e):r.current_term(function(t){c(n.dept,t,e)}):n.justcode?n.term?u(n.term):r.current_term(u):console.error("Please at LEAST include {justcode:true}")},r.course=function(e,t){function o(e,t,o,n,c){r.course_raw(function(r){(r.ScheduledCourseID==e+"-"+t+o||r.CourseData.prefix==e&&r.CourseData.number==t)&&c(r.CourseData)},{dept:e,term:n})}if(t=t||{},t.course){t.course=t.course.toUpperCase();var n=t.course.split("-");n[1].length>3&&(n[2]=n[1].substring(3),n[1]=n[1].substring(0,3)),2!=n.length&&3!=n.length||!isNaN(n[0])||isNaN(n[1])?console.error("courseid format incorrect"):t.term?o(n[0],n[1],n[2],t.term,e):r.current_term(function(t){o(n[0],n[1],n[2],t,e)})}else console.error("Need a course")},r.sect=function(e,o){o=o||{},r.course(function(r){o.sect?(o.sect=o.sect.substring(0,5),r.SectionData.id==sect&&e(r.SectionData)):t.each(r.SectionData,function(t,r){e(t)})},{course:o.course,term:o.term})},"object"==typeof module&&module.exports?module.exports=r:"function"==typeof define&&define.amd?define([],function(){return r}):root.TROJAN=r}();