"use strict";!function(){var e={};const t=require("http"),r=require("./async");var o=function(e,r){function o(){t.get(e,function(e){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){try{var e=JSON.parse(t);r(e)}catch(o){}})}).on("error",function(e){console.error("Error: ",e)})}e="http://web-app.usc.edu/web/soc/api"+e,setTimeout(o,150)};e.term=function(e,t){t=t||{};var r="/terms";o(r,function(r){e(t.curr?r.term[r.term.length-1]:r.term)})},e.current_term=function(t,r){e.term(t,{curr:!0})},e.dept_raw=function(t,r){function n(e){var r="/depts/"+e;o(r,function(e){t(e.department)})}r=r||{},r.term?n(r.term):e.current_term(n)},e.school=function(t,o){function n(e){r.each(e,function(e,r){(school=o.school)?e.code.toLowerCase()==school.toLowerCase()&&t(e):t(e.code),r()})}o=o||{},o.data_dump?n(o.data_dump):e.dept_raw(n,{term:o.term})},e.dept=function(t,o){function n(e){var n=[];r.each(e,function(e,r){function c(e,r){n.indexOf(e.code)>-1||(n.push(e.code),t(o.justcode?e.code:e)),r()}depts=e.department,Array.isArray(depts)?each(depts,c):void 0!=depts&&c(depts),r()})}o=o||{},e.dept_raw(function(t){o.school?e.school(function(e){n([e])},{school:o.school,data_dump:t}):n(t)},{term:o.term})},e.dept_info=function(t,r){function n(e,t,r){var n="/classes/"+e+"/"+t;o(n,function(e){r(e.Dept_Info)})}function c(r){e.dept(function(e){n(e,r,t)},{term:r,justcode:!0})}r=r||{},r.dept?r.term?n(r.dept,r.term,t):e.current_term(function(e){n(r.dept,e,t)}):r.term?c(r.term):e.current_term(function(e){c(e)})},e.course_raw=function(t,n){function c(e,t,c){var u="/classes/"+e+"/"+t;o(u,function(e){var t=e.OfferedCourses.course;Array.isArray(t)?r.each(t,function(e,t){c(n.justcode?e.ScheduledCourseID:e),t()}):void 0!=t&&c(n.justcode?t.ScheduledCourseID:t)})}function u(r){e.dept(function(e){c(e,r,t)},{justcode:!0})}n=n||{},n.dept?n.term?c(n.dept,n.term,t):e.current_term(function(e){c(n.dept,e,t)}):n.justcode?n.term?u(n.term):e.current_term(u):console.error("Please at LEAST include {justcode:true}")},e.course=function(t,r){function o(t,r,o,n,c){e.course_raw(function(e){(e.ScheduledCourseID==t+"-"+r+o||e.CourseData.prefix==t&&e.CourseData.number==r)&&c(e.CourseData)},{dept:t,term:n})}if(r=r||{},r.course){r.course=r.course.toUpperCase();var n=r.course.split("-");n[1].length>3&&(n[2]=n[1].substring(3),n[1]=n[1].substring(0,3)),2!=n.length&&3!=n.length||!isNaN(n[0])||isNaN(n[1])?console.error("courseid format incorrect"):r.term?o(n[0],n[1],n[2],r.term,t):e.current_term(function(e){o(n[0],n[1],n[2],e,t)})}else console.error("Need a course")},e.sect=function(t,o){o=o||{},e.course(function(e){o.sect?(o.sect=o.sect.substring(0,5),e.SectionData.id==sect&&t(e.SectionData)):r.each(e.SectionData,function(e,r){t(e)})},{course:o.course,term:o.term})},"object"==typeof module&&module.exports&&(module.exports=e)}();